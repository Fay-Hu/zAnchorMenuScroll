{"version":3,"sources":["zAnchorScroll.js"],"names":["window","zAnchorScroll","args","Anchor","anchorContainer","anchorTagName","scrollContentContainer","scrollTagName","this","prototype","init","throttle","method","context","clearTimeout","tId","setTimeout","call","f_scrollTop","f_filterResults","pageYOffset","document","documentElement","scrollTop","body","n_win","n_docel","n_body","n_result","getChildNode","parent","tagName","tempList","i","childNodes","length","nodeType","toLowerCase","push","detemineWitchPartToActive","GetRect","element","rect","getBoundingClientRect","top","clientTop","left","clientLeft","bottom","right","scrollLists","innerHeight","currentIndex","indexOf","updateAnchorStatus","replaceAll","operateStr","toReplace","innerReplace","str","str2","newStr","replace","bufferMove","obj","attr","target","clearInterval","timer","speed","setInterval","offsetTop","Math","ceil","floor","style","anchorLists","className","oActiveBar","_this","createElement","display","position","width","height","zIndex","appendChild","addEventListener","e","scrollbarMoveTo","offsetHeight","scrollTo","newAnchor"],"mappings":"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","file":"zAnchorScroll.min.js","sourcesContent":["/* name : zAnchorScroll */\r\n/* date : 2016-12-29 */\r\n/* author : Yahone */\r\n/* version : 1.0.0 */\r\n\r\n(function(window) {\r\n    // expose for called\r\n    window.zAnchorScroll = function(args) {\r\n        // structure func\r\n        function Anchor(anchorContainer, anchorTagName, scrollContentContainer, scrollTagName) {\r\n            // anchor's parentNode: dom node(cant' be nodeList)\r\n            this.anchorContainer = anchorContainer;\r\n            // anchor's TagName : lowercase\r\n            this.anchorTagName = anchorTagName;\r\n            // scrollContent's parentNode : dom node(cant' be nodeList)\r\n            this.scrollContentContainer = scrollContentContainer;\r\n            // scrollContent's TagName : lowercase\r\n            this.scrollTagName = scrollTagName;\r\n        }\r\n        // initailize\r\n        Anchor.prototype.init = function() {\r\n            // Function throttling\r\n            function throttle(method, context) {\r\n                clearTimeout(method.tId);\r\n                method.tId = setTimeout(function() {\r\n                    method.call(context);\r\n                }, 100);\r\n            }\r\n\r\n            // all anchors transto pseudo array\r\n            var anchorLists = getChildNode(this.anchorContainer, this.anchorTagName),\r\n                // all scroll content transto pseudo array\r\n                scrollLists = getChildNode(this.scrollContentContainer, this.scrollTagName),\r\n                // this pointer\r\n                _this = this,\r\n                // current item\r\n                currentIndex = 0,\r\n                // create a activeBar element\r\n                oActiveBar = document.createElement('span');\r\n\r\n            // when page is loaded , if scrollBar isn't on the top\r\n            // detemine the page on which part and highlight its correspond anchor\r\n            detemineWitchPartToActive();\r\n\r\n            // modified and append oActiveBar\r\n            oActiveBar.className = \"activeBar\";\r\n            oActiveBar.style.top = 0;\r\n            oActiveBar.style.display = \"block\";\r\n            oActiveBar.style.position = \"absolute\";\r\n            oActiveBar.style.width = \"100%\";\r\n            oActiveBar.style.height = \"20px\";\r\n            oActiveBar.style.zIndex = \"1\";\r\n            this.anchorContainer.appendChild(oActiveBar);\r\n\r\n            this.timer = null;\r\n\r\n            this.anchorContainer.addEventListener('click', function(e) {\r\n                // 如果事件源来自目标类型的标签\r\n                if (e.target.tagName.toLowerCase() === _this.anchorTagName) {\r\n                    // update currentIndex\r\n                    currentIndex = anchorLists.indexOf(e.target);\r\n                    scrollbarMoveTo(scrollLists[currentIndex].offsetTop);\r\n                    updateAnchorStatus();\r\n                }\r\n\r\n                // def func\r\n                function scrollbarMoveTo(target) {\r\n                    // target's maximum value is (pageHeight - clientHeight)\r\n                    target = target > (document.body.offsetHeight - window.innerHeight) ? (document.body.offsetHeight - window.innerHeight) : target;\r\n                    clearInterval(_this.timer);\r\n                    var speed = 0;\r\n                    _this.timer = setInterval(function() {\r\n                        if (f_scrollTop() !== target) {\r\n                            speed = (target - f_scrollTop()) / 3;\r\n                            speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);\r\n                            window.scrollTo(0, f_scrollTop() + speed);\r\n                        } else {\r\n                            clearInterval(_this.timer);\r\n                        }\r\n                    }, 30);\r\n                }\r\n\r\n            }, false);\r\n\r\n            // getScrollTop\r\n            function f_scrollTop() {\r\n                return f_filterResults(\r\n                    window.pageYOffset ? window.pageYOffset : 0,\r\n                    document.documentElement ? document.documentElement.scrollTop : 0,\r\n                    document.body ? document.body.scrollTop : 0\r\n                );\r\n            }\r\n            // determine result\r\n            function f_filterResults(n_win, n_docel, n_body) {\r\n                var n_result = n_win ? n_win : 0;\r\n                if (n_docel && (!n_result || (n_result > n_docel)))\r\n                    n_result = n_docel;\r\n                return n_body && (!n_result || (n_result > n_body)) ? n_body : n_result;\r\n            }\r\n            // get ChildNodes\r\n            function getChildNode(parent, tagName) {\r\n                var tempList = []\r\n                for (var i = 0; i < parent.childNodes.length; i++) {\r\n                    parent.childNodes[i]\r\n                    if (parent.childNodes[i].nodeType === 1 && parent.childNodes[i].tagName.toLowerCase() === tagName) {\r\n                        tempList.push(parent.childNodes[i])\r\n                    }\r\n                }\r\n                return tempList\r\n            }\r\n            // when mousewhell \r\n            window.addEventListener('scroll', function(e) {\r\n                throttle(detemineWitchPartToActive, window);\r\n            }, false);\r\n\r\n            function detemineWitchPartToActive() {\r\n                function GetRect(element) {\r\n                    var rect = element.getBoundingClientRect();\r\n                    var top = document.documentElement.clientTop;\r\n                    var left = document.documentElement.clientLeft;\r\n                    return {\r\n                        // dom top to the browser top (clientX 0 line)\r\n                        top: rect.top - top,\r\n                        // dom bottom to the browser top (clientX 0 line)\r\n                        bottom: rect.bottom - top,\r\n                        // dom left to the browser left (clientY 0 line)\r\n                        left: rect.left - left,\r\n                        // dom right to the browser left (clientY 0 line)\r\n                        right: rect.right - left\r\n                    };\r\n                }\r\n\r\n                // enumerate the scroll content lists\r\n                for (var i = 0; i < scrollLists.length; i++) {\r\n                    // if dom topLine nearby the clientX Line ( Deviation 100px)\r\n                    // if dom topLine under the clientX Line\r\n                    // if dom bottomLine above the clientHeight 1/2 line\r\n                    if (GetRect(scrollLists[i]).top > -100 ||\r\n                        GetRect(scrollLists[i]).bottom > window.innerHeight * 0.5) {\r\n                        currentIndex = scrollLists.indexOf(scrollLists[i]);\r\n\r\n                        updateAnchorStatus();\r\n\r\n                        return false;\r\n                    }\r\n                }\r\n            }\r\n\r\n            // update the anchor status\r\n            function updateAnchorStatus() {\r\n                // remove class \"active\" from all anchors\r\n                for (var i = 0; i < anchorLists.length; i++) {\r\n                    anchorLists[i].className = replaceAll(anchorLists[i].className, 'active');\r\n                }\r\n\r\n                // replaceAll the 'active' class\r\n                function replaceAll(operateStr, toReplace) {\r\n                    var newStr = \"\";\r\n                    innerReplace(operateStr, toReplace);\r\n\r\n                    function innerReplace(str, str2) {\r\n                        if (str.indexOf(toReplace) !== -1) {\r\n                            newStr = str.replace(str2, '');\r\n                            innerReplace(newStr, str2);\r\n                        } else {\r\n                            return;\r\n                        }\r\n                    }\r\n                    return newStr;\r\n                }\r\n\r\n                // highlight  \r\n                anchorLists[currentIndex].className += ' active';\r\n                // move the active Bar\r\n                bufferMove(oActiveBar, 'top', anchorLists[currentIndex].offsetTop);\r\n\r\n                function bufferMove(obj, attr, target) {\r\n                    clearInterval(obj.timer);\r\n                    var speed = 0;\r\n                    obj.timer = setInterval(function() {\r\n                        if (obj.offsetTop !== target) {\r\n                            speed = (target - obj.offsetTop) / 3;\r\n                            speed = speed > 0 ? Math.ceil(speed) : Math.floor(speed);\r\n                            obj.style.top = obj.offsetTop + speed + \"px\";\r\n                        } else {\r\n                            clearInterval(obj.timer);\r\n                        }\r\n                    }, 30);\r\n                }\r\n            }\r\n        };\r\n        // new instance\r\n        var newAnchor = new Anchor(args.anchorContainer, args.anchorTagName, args.scrollContentContainer, args.scrollTagName);\r\n        // init\r\n        // waiting for IE load\r\n        setTimeout(function() {\r\n            newAnchor.init();\r\n        }, 500);\r\n    };\r\n})(window);\r\n"]}